# Section31 : 우리의 첫 번째 도구: 노드(Node)

## Node.js 개요

> Node.js는 Chrome V8 JavaScript 엔진으로 빌드 된 JavaScript 런타임이다.

즉, 노드를 통해 다양한 자바스크립트 애플리케이션을 실행할 수 있으며, 서버를 실행하는 데 제일 많이 사용된다.

- Node.js는 JavaScript를 서버에서도 사용할 수 있도록 만든 프로그램이다.
- Node.js는 V8이라는 JavaScript 엔진 위에서 동작하는 자바스크립트 런타임(환경)이다.
- Node.js는 서버사이트 스크립트 언어가 아니다. 프로그램(환경)이다.
- Node.js는 웹서버와 같이 확장성 있는 네트워크 프로그램을 제작하기 위해 만들어졌다.

Node.js는 확장성이 있는 네트워크 애플리케이션 개발에 사용되는 소프트웨어 플랫폼이다. 특히 서버사이트에서 많이 사용되고 있다.  
사용되는 언어로는 자바스크립트를 활용하며, Non-blocking I/O와 단일 스레드 이벤트 루프를 통한 높은 처리 성능을 가지고 있는 것이 특징이다.

내장 HTTP 서버 라이브러리를 포함하고 있어 웹 서버에서 아파치 등의 별도 소프트웨어 없이 동작하는 것이 가능하며, 이를 통한 웹 서버의 동작에 있어 더 많은 통제에서 벗어나 여러 가지 기능을 가능하게 한다.

즉, Node.js를 통해 웹애플리케이션이 더욱 발전하게 되었으며, 정적인 홈페이지 뿐만 아니라 쇼핑몰, 티켓예매사이트, 블로그 등 데이터가 변해가는 사이트를 만들 수 있으며, 여러 개발자가 만든 프로그램과 게임을 웹상에서 구동시켜 플랫폼의 제약에서 벗어나 어디든 상관없이 실행가능하게 해준다.

물론 단순히 웹에서 실행 가능한 게임을 만들려면 JavaScript 만으로도 가능하지만 좀 더 진화 된 프로그램으로 실시간 온라인 채팅, 실시간 온라인 게임 등 실시간 기능을 넣거나, 로그인 기능을 넣어 유저를 관리하고 점수를 관리하는 데이터베이스 기능을 Node.js를 통해 만들 수 있다.

### Node.js 사용이유

- JavaScript는 독립적인 언어가 아닌 스크립트 언어이다. 스크립트 언어는 특정한 프로그램 안에서 동작하는 프로그램이기 때문에 웹 브라우저 프로그램 안에서만 동작을 한다.
- JavaScript를 웹 브라우저에서 독립시킨 것으로 Node.js를 설치하게 되면 터미널프로그램(윈도우의 cmd, 맥의 terminal)에서 Node.js를 입력하여 브라우저 없이 바로 실행할 수 있다.
- 이렇게 Node.js를 이용하여 웹 브라우저와 무관한 프로그램을 만들 수 있다.
- 중요한 것은 Node.js를 이용하여 서버를 만들 수 있다는 것이다.
- 이전까지 Server-Client 웹사이트를 만들 때 웹에서 표시되는 부분은 JavaScript를 사용하여 만들어야 했으며, 서버는 Reby, Java 등 다른 언어를 사용하여 만들어야 했는데 마침내 한 가지 언어로 전체 웹 페이지를 만들 수 있게 된 것이다.

### 자바스크립트 런타임

런타임이란 특정 언어로 만든 프로그램을 실행할 수 있는 환경을 뜻한다.  
따라서 노드는 자바스크립트 프로그램을 컴퓨터에서 실행할 수 있게 하는 자바스크립트 실행기이다.

### 이벤트 기반

노드는 V8과 더불어 libuv라는 라이브러리를 사용한다.  
libuv 라이브러리는 노드의 특성인 이벤트 기반, 논 블로킹 I/O모델을 구현하고 있다.  
이벤트 기반(Event-driven)이란 이벤트가 발생할 때 미리 지정해둔 작업을 수행하는 방식을 의미한다. 즉, 이벤트 기반 시스템에서는 특정 이벤트가 발생할 때 무엇을 할지 미리 등록해두고, 이를 이벤트 리스너에 콜백함수로 등록한다. 이후 이벤트가 발생하면 리스너에 등록해둔 콜백함수를 호출하며, 이벤트가 끝난 후 노드는 다음 이벤트가 발생할 때까지 대기한다.

### 이벤트 루프

여러 이벤트가 동시에 발생했을 때 어떤 순서로 콜백함수를 호출 할지를 이벤트 루프가 판단한다. 노드는 이벤트가 종료될 때까지 이벤트 처리를 위한 작업을 반복하므로 루프(loof)라고 부른다.

### 논 블로킹 I/O

이벤트 루프를 잘 활용하면 오래 걸리는 작업을 효율적으로 처리할 수 있다.  
작업에는 두 가지 종류가 있는데 동시에 실행될 수 있는 작업과 동시에 실행될 수 없는 작업이다. 특히 파일 시스템 접근, 네트워크를 통한 요청 작업은 입력(Input)/출력(Output)의 일종이며, 이러한 작업을 할 때 노드는 비동기 방식으로 블로킹을 만들지 않게끔(논 블로킹) 처리한다.  
비동기란 이전 작업이 완료될 때까지 대기하지 않고 동시에 작업을 수행한다. 반대로 동기는 이전 작업이 끝나야만 다음 작업을 수행한다.

### 싱글 스레드

이벤트 기반, 논 블로킹 모델과 더불어 노드를 설명하는 키워드 중 하나는 싱글 스레드이다.  
자바스크립트 코드는 동시에 실행될 수 없는데 그 이유는 노드가 싱글 스레드 기반이기 때문이다.

- 프로세스 : 운영체제에서 할당하는 작업의 단위이다. 노드나 웹 브라우저 같은 프로그램은 개별적인 프로세스이다. 프로세스 간에는 메모리 등의 자원을 공유하지 않는다.
- 스레드 : 스레드는 프로세스 내에서 실행되는 흐름의 단위이다. 프로세스는 스레드를 여러 개 생성해 여러 작업을 동시에 처리할 수 있다. 스레드들은 부모 프로세스의 자원을 공유한다. 같은 주소의 메모리에 접근 가능하므로 데이터를 공유할 수 있다.

Node.js는 싱글스레드, 논 블로킹 모델로 싱글 스레드가 혼자서 일을 처리하지만 들어오는 요청 순서가 아닌 논 블로킹 방식으로 이전 작업이 완료될 때까지 대기하지 않고 다음 작업을 수행한다.

## Node REPL

Read-Eval(evaluation)-Print-Loop 의 약어이다.  
사용자가 특정 코드를 입력하면 그 코드를 평가하고 실행결과를 출력해주는 것을 반복해주는 환경을 말한다.
Node REPL 에서는 전역 객체가 Window가 아니라 global이다.  
Node 에서는 브라우저에서 다룰 수 없는 모듈을 사용해서 여러 가지 기능을 구현할 수 있다.

## Node 파일 실행

Node REPL 에 node 파일명 을 입력하면 파일이 실행된다.

## 프로세스와 Argv

node -v 을 입력하면 현재 설치된 node의 버전을 볼 수 있다.
Node의 process는 수많은 메서드를 가지고 있는 거대한 객체이다.  
다양한 기능이 있고, 공식 문서에서 확인이 가능하다.  
process.argv 메서드를 사용하면 배열이 반환된다.  
첫 번째 인덱스는 실행할 수 있는 경로고 두 번째 인덱스는 실행하고 있는 파일 경로이다. 세번 째 인덱스로 인수를 넣으면 인수가 추가된 배열을 반환한다. 인수는 명령줄로도 넣을 수 있다.

> node greeter.js colt rusty tammy chicken  
> colt rusty tammy chicken 네 개의 인수를 greeter.js 파일에 전달한다.
